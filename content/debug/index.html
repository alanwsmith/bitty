<DOCTYPE html>
<html lang="en">
<head>
<style>
body {
  color: goldenrod;
  background-color: black;
}
</style>
<script>
const template = `<button data-send="send2">Click me</button>`;

function sleep(ms) {
  return new Promise((resolve) => setTimeout(resolve, ms));
}

function findLargePrimes(limit) {
    const primes = [];
    function isPrime(num) {
        // Intentionally inefficient primality test with O(n) complexity
        if (num <= 1) return false;
        for (let i = 2; i < num; i++) {
            // Deliberately slow checking process
            for (let j = 0; j < 1000; j++) {
                Math.sqrt(j); // Add some extra computational overhead
            }
            if (num % i === 0) {
                return false;
            }
        }
        return true;
    }
    // Nested loops to make the function extremely time-consuming
    for (let num = 2; num < limit; num++) {
        if (isPrime(num)) {
            primes.push(num);
        }
    }
    return primes;
}

window.BittyClassToMove = class {

  #counter = 0;

  /*
  bittyReady() {
    console.log("HERE1: bittyReady()");
    // this.api.trigger("runTest0077");
    this.api.trigger("runTest0850Alfa");
    this.api.trigger("runTest0850Bravo");
  }
  */

  async doSleep() {
    await sleep(1000);
  }

  runTest0850Alfa(_event, el) {
    if (el) {
      const editEl = this.api.querySelector("#testTarget0850");
      this.#counter += 1;
      console.log("runTest0850Alfa")
      findLargePrimes(9000);
      // el.innerHTML = "ALFA";
      el.innerHTML = editEl.innerHTML;
      editEl.innerHTML = "b";
      findLargePrimes(9000);
    }
  }

  runTest0850Bravo(_event, el) {
    if (el) {
      const editEl = this.api.querySelector("#testTarget0850");
      this.#counter += 1;
      console.log("runTest0850Bravo")
      findLargePrimes(1000);
      // el.innerHTML = "BRAVO";
      //el.innerHTML = this.#counter;
      el.innerHTML = editEl.innerHTML;
      editEl.innerHTML = "y";
    }
  }

  runTest0077(_event, _el) {
    this.api.trigger("triggerEvent0077");
  }

  triggerEvent0077(_event, el) {
    if (el) {
    el.innerHTML = "PASSED";
    }
  }

  runThing(_, el) {
    const button = this.api.makeElement(template);
    el.replaceChildren(button);
    button.click()
  }

  send2(_, el) {
    if (el) {
      el.innerHTML = "UPDATED";
    }
  }

  init(_event, el) {
    el.click();
  }

  runTest0010(_event, el) {
    el.innerHTML = "PASSED";
  }

  runTest0075(event, _el) {
    this.api.forward(event, "forwardEvent0075");
  }

  forwardEvent0075(_event, el) {
    el.innerHTML = "PASSED";
  }

  #testValue0630 = false;

  checkTest0630(_event, el) {
    if (this.#testValue0630 === true) {
      el.innerHTML = "PASSED";
    } else {
      el.innerHTML = "FAILED";
    }
  }

  async runTest0630(_event, _el) {
    console.log(`doing: runTest0630`);
    await sleep(300);
    // await sleep(300);
    this.#testValue0630 = true;
  }
}

window.debug0880Alfa = class {
  bittyReady() {
    this.api.querySelector("button").click();
  }
  run0880(event, _el) {
    this.api.forward(event, 'debug0880BravoForward');
  }
}

window.debug0880Bravo = class {
  /*
  bittyReady() {
    this.api.trigger('debug0880BravoForward');
  }
  */

  debug0880BravoForward(event, el) {
    el.innerHTML = "PASSED";
  }
}

window.ElementSendEventTest = class {
  triggerSendEvent(_event, el) {
    el.innerHTML = "PASSED";
  }
}

function randInt(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}

const postTemplate2 = `<div>here is what the inner is: POST_INNER</div>`;
const postContentTemplate = `hello world RAND`;

window.makeHTMLDebug = class {
  debugTest0890(_, el) {
    const content = this.api.makeHTML(postContentTemplate, [
      ["RAND", randInt(0, 1000)],
    ]);
    // console.log(content);
    const post = this.api.makeHTML(postTemplate2, [
      ["POST_INNER", content],
    ]);
    el.appendChild(post);
  }
}

window.BittyClass = class {
    theDate(_event, el) {
      el.innerHTML = new Date();
    }
}

</script>
</head>
<body>

<!--

      <script>
      </script>
      <bitty-6-0 data-connect="">
      </bitty-6-0>
-->


      <script>

      window.TestCase0220 = class {
  #counterAlfa = 0;
  #counterBravo = 0;
  #counterCharlie = 0;
  #counterDelta = 0;

  bittyInit() {
    const button = this.api.querySelector("button");
    button.click();
    button.click();
    button.click();
    button.click();
  }

  runTest0220(event, element) {
    this.#counterAlfa += 1;
    event.target.dataset.counter = `${this.#counterAlfa}`;
    if (event.target.dataset.counter == "4") {
      element.innerHTML = "PASSED";
    }
     this.api.forward(event, "secondSignal0220");
  }

  secondSignal0220(event, element) {

    this.#counterBravo += 1;
    event.sender.dataset.counter = `${this.#counterBravo}`;
    if (event.target.dataset.counter == "4") {
      element.innerHTML = "PASSED";
    }
    this.api.forward(event, "thirdSignal0220");
  }

  thirdSignal0220(event, element) {
    this.#counterCharlie += 1;
    event.target.dataset.counter = `${this.#counterCharlie}`;
    if (event.target.dataset.counter == "4") {
      element.innerHTML = "PASSED";
    }
    this.api.forward(event, "fourthSignal0220");
  }

  fourthSignal0220(event, element) {
    this.#counterDelta += 1;
    event.target.dataset.counter = `${this.#counterDelta}`;
    if (event.target.dataset.counter == "4") {
      element.innerHTML = "PASSED";
    }

      }
}

      </script>
      <bitty-6-0 data-connect="TestCase0220">

    <button data-send="runTest0220">Test Trigger</button>
    <div class="test" data-receive="runTest0220">FAILED</div>
    <div class="test" data-receive="secondSignal0220">FAILED</div>
    <div class="test" data-receive="thirdSignal0220">FAILED</div>
    <div class="test" data-receive="fourthSignal0220">FAILED</div>

      </bitty-6-0>




      <!--
      <script>
      window.RunTest0077 = class {
        bittyReady() {
          console.log("here1");
          this.api.trigger("runTest0077");
        }

        runTest0077(_event, _el) {
          console.log("here2");
          this.api.trigger("triggerEvent0077");
        }

        triggerEvent0077(_event, el) {
          console.log("here3");
          el.innerHTML = "PASSED";
        }
      }
      </script>
      <bitty-6-0 data-connect="RunTest0077">
        <div class="test" data-receive="triggerEvent0077">FAILED</div>
      </bitty-6-0>

-->


      <!--
      <script>
      window.RunTest0075b = class {
        runTest0075b(event, _el) {
          this.api.forward(event, "forwardEvent0075b");
        }
        forwardEvent0075b(_event, el) {
          el.innerHTML = "PASSED";
        }
      }
      </script>
      <bitty-6-0 data-connect="RunTest0075b">
        <div data-init="runTest0075b"></div>
        <div class="test" data-receive="forwardEvent0075b">FAILED</div>
      </bitty-6-0>
-->

<!--
      <script>
      window.RunTest0075a = class {
        bittyInit() {
          this.api.forward(event, "forwardEvent0075a");
        }
        forwardEvent0075a(_event, el) {
          el.innerHTML = "PASSED";
        }
      }
      </script>
      <bitty-6-0 data-connect="RunTest0075a">
        <div class="test" data-receive="forwardEvent0075a">FAILED</div>
      </bitty-6-0>
-->

      <!--

      <script>
      window.RunTest0020 = class {
        runTest0020(_event, el) {
          el.innerHTML = "PASSED";
        }
      }
      </script>
      <bitty-6-0 data-connect="RunTest0020" data-init="runTest0020">
        <div class="test" data-receive="runTest0020">FAILED</div>
      </bitty-6-0>

-->

      <!--
      <script>
      window.RunTest0010= class {
        bittyInit() {
          this.api.querySelector("button").click();
        }
        runTest0010(_event, el) {
          el.innerHTML = new Date();
        }
      }
      </script>
      <bitty-6-0 data-connect="RunTest0010">
        <div class="test" data-receive="runTest0010">FAILED</div>
        <button data-send="runTest0010">Test Trigger</button>
      </bitty-6-0>
-->

<!--
      <script>
      window.BittyInitTriggerTest = class {
        bittyInit() {
          this.api.trigger("initTriggerTest");
        }
        initTriggerTest(event, el) {
          el.innerHTML = "lkwejrlwejreweklrjwlekjrewkljl";
        }
      }
      </script>
      <bitty-6-0 data-connect="BittyInitTriggerTest">
        <div data-receive="initTriggerTest">waiting</div>
      </bitty-6-0>
-->

      <!--
      <script>
      window.BittyInitTest = class {
        bittyInit() {
          console.log("it fired");
        }
      }
      </script>
      <bitty-6-0 data-connect="BittyInitTest"></bitty-6-0>
-->

      <!--
      <script>
      window.SelfInitTest = class {
        constructor(){
          console.log("connected");
        }
        selfInitTest(event, el) {
          console.log("asdf");
          el.innerHTML = "asdfasdfas";
        }
      }
      </script>
      <style>
      </style>
      <bitty-6-0 data-connect="SelfInitTest" data-init="selfInitTest">
          <div data-receive="selfInitTest">waiting</div>
      </bitty-6-0>
-->



      <!--
      <bitty-6-0>
  <button data-send="theDate">Show Date</button>
  <div data-receive="theDate">waiting</div>
      </bitty-6-0>
-->

      <!--
<bitty-5-1 data-connect="makeHTMLDebug">
  <div data-init="debugTest0890">FAILED</div>
</bitty-5-1>

-->


      <!--
      <bitty-5-1 data-connect="ElementSendEventTest" 
        data-send="triggerSendEvent"
      >
        <div data-receive="triggerSendEvent">FAILED</div>
      </bitty-5-1>


      <bitty-5-1 data-connect="debug0880Alfa">
        <button data-send="run0880">Run 0880</button>
      </bitty-5-1>

      <bitty-5-1 data-connect="debug0880Bravo">
        <div data-receive="debug0880BravoForward">FAILED</div>
      </bitty-5-1>
-->


      <!--
<bitty-5-1 
  data-send="asdf await:runTest0630 checkTest0630">
  <div data-receive="asdf checkTest0630">WAITING</div>
</bitty-5-1>

<bitty-5-1>
        <div id="testTarget0850">a</div>
  <div class="test" data-receive="runTest0850Alfa">FAILED</div>
  <div class="test" data-receive="runTest0850Bravo">FAILED</div>
</bitty-5-1>

<bitty-5-1>
  <div class="test" data-receive="triggerEvent0077">FAILED</div>
</bitty-5-1>

<bitty-5-1 data-send="init0010">
  <div class="test" data-receive="runTest0010">FAILED</div>
  <button data-receive="init0010" data-send="runTest0010">Test Trigger</button>
</bitty-5-1>

<bitty-5-1>
  <div data-init="runTest0075">Test Trigger</div>
  <div class="test" data-receive="forwardEvent0075">FAILED</div>
</bitty-5-1>

<bitty-5-1>
<div data-init="runThing">WAITING</div>
  <div data-receive="send2">WAITING</div>
  <div data-receive="send2">WAITING</div>
  <div data-receive="send2">WAITING</div>
  <div data-receive="send2">WAITING</div>
</bitty-5-1>

-->

<script src="/release/bitty-6.0.0-rc1.full.js" type="module"></script>
</body>
</html>
